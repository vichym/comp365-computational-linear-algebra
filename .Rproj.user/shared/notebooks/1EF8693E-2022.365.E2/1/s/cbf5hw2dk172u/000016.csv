"0","# uncomment these two lines "
"0","index0<-250"
"0","index1<-350"
"0","x0<-xx[index0]"
"0","x1<-xx[index1]"
"0",""
"0","plot.local.lines<-function(sigma,x0,x1,xx,yy){"
"0","  "
"0","  fx0<-find.local.line(x0,sigma,xx,yy)"
"0","  P4Data$l0<-fx0(xx)"
"0","  P4Data$k0<-exp(-(xx-x0)^2/(2*sigma^2))"
"0","  fx1<-find.local.line(x1,sigma,xx,yy)"
"0","  P4Data$l1<-fx1(xx)"
"0","  P4Data$k1<-exp(-(xx-x1)^2/(2*sigma^2))"
"0","  LocLinPred<-data.frame(x=c(x0,x1),y=c(fx0(x0),fx1(x1)))"
"0","  ggplot(P4Data,aes(x=xx,y=yy))+"
"0","    geom_point()+xlab(""x"")+ylab(""y"")+"
"0","    geom_line(aes(x=xx,y=l0),col=""goldenrod2"",size=1.5)+"
"0","    geom_line(aes(x=xx,y=k0),col=""goldenrod2"",size=1.5,linetype=""dashed"")+"
"0","    geom_line(aes(x=xx,y=l1),col=""lightseagreen"",size=1.5)+"
"0","    geom_line(aes(x=xx,y=k1),col=""lightseagreen"",size=1.5,linetype=""dashed"")+"
"0","    ylim(-1.5,3.5)+"
"0","    geom_point(data=LocLinPred,aes(x=x,y=y),col=""red"",size=4)"
"0","}"
"0",""
"0","sigma<-5"
"0","plot.local.lines(sigma,x0,x1,xx,yy)"
