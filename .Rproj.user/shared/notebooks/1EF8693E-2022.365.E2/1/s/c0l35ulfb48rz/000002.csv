"0","find.local.line<-function(x0,sigma,xx,yy){"
"0","# Insert your code here and then activate the next chunk and uncomment the two lines in the following chunk"
"0","  w_sqrt_root = sqrt(exp(-(xx - x0)^2 / 2*sigma^2))"
"0","  A_hat = cbind(w_sqrt_root , w_sqrt_root*xx)"
"0","  z = cbind(w_sqrt_root*yy)"
"0","  A_hat_T = t(A_hat)"
"0","  coeff =  solve(A_hat_T %*% A_hat, A_hat_T %*% yy)"
"0","  "
"0","  fx = function(xx){"
"0","    A = cbind(rep(1, length(xx)), xx)"
"0","    pred = A%*%coeff"
"0","  return(pred)"
"0","  }"
"0","  "
"0","  return(fx)"
"0","}"
